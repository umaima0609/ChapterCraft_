<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ChapterCraft</title>
  <link rel="icon" href="./image/logo.png" type="image/x-icon" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous" />
  <link rel="stylesheet" href="./style.css" />
</head>

<body>


  <div class="main-box">
    <h2 class="login-heading">Wellcome Back!</h2>
    <p class="head-para">We are happy to have you back.</p>
    <div class="main-form" id="MainForm">
      <form>
        <label for="email">Email/UserName:</label>
        <input type="email" name="email" id="emailInp" required />

        <label for="password">Password:</label>
        <input type="password" name="password" id="passwordInp" required />

        <div class="button">
          <button type="submit" class="btn">Login</button>
        </div>
        <p class="account-heading">Don't have an account.</p>
        <a href="./register.html" class="page-link">Sign Up</a>
      </form>
    </div>
  </div>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      var inputFields = document.querySelectorAll("form input");

      inputFields.forEach(function (input) {
        input.addEventListener("input", function () {
          if (input.value) {
            input.classList.add("not-empty");
          } else {
            input.classList.remove("not-empty");
          }
        });
      });
    });
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
    crossorigin="anonymous"></script>

  <!-- <script src="./js/login.js"></script> -->

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.2/firebase-app.js";
    import {
      getDatabase,
      get,
      ref,
      child,
    } from "https://www.gstatic.com/firebasejs/10.7.2/firebase-database.js";
    import {
      getAuth,
      signInWithEmailAndPassword,
    } from "https://www.gstatic.com/firebasejs/10.7.2/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBn8ij2kc2D0hJIMSv-n8R3UbbQlXLdC8k",
      authDomain: "fir-project-7cfeb.firebaseapp.com",
      databaseURL: "https://fir-project-7cfeb-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "fir-project-7cfeb",
      storageBucket: "fir-project-7cfeb.appspot.com",
      messagingSenderId: "150973541904",
      appId: "1:150973541904:web:8bdff2a48b439d493e6495",
      measurementId: "G-ELDM4WDWWL",
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase();
    const auth = getAuth(app);
    const dbref = ref(db);

    let EmailInp = document.getElementById("emailInp");
    let PassInp = document.getElementById("passwordInp");
    let MainForm = document.getElementById("MainForm");

    let SignInUser = (evt) => {
      evt.preventDefault();
      signInWithEmailAndPassword(auth, EmailInp.value, PassInp.value)
        .then((credential) => {
          sessionStorage.setItem(
            "user-creds",
            JSON.stringify(credential.user)
          );
          window.location.href = "index.html";

        })

        .catch((error) => {
          alert(error.message);
          console.log(error.code);
          console.log(error.message);
        });
    };
    MainForm.addEventListener("submit", SignInUser);
  </script>

</body>

</html>